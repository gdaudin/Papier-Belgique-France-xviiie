version 14global dir "~/Documents/Recherche/Commerce XVIIIe-XIXe Europe/Belgique/Papier Ann - Loïc/Statistiques"cd "$dir"capture program drop graphiques_en_valeurprogram graphiques_en_valeurlocal bien `1'*exemple : graphiques_en_valeur Coal //   graphiques_en_valeur Sugaruse "Stata/RG_base courante.dta", clearif "`bien'"=="Coal" {	**********	***Pour charbon (pas "Terre ; houille")	**************	keep if strmatch(marchandises_simplification,"*harbon*")==1	drop if strmatch(marchandises_simplification,"*bois*")==1	*I found them in sources on the Coal trade within the archives of the Finance Council: (copy from a chapter I wrote on Coal) 	*"In the customs statistics regular Coal was partly noted in “charretées” (cartloads) and partly in “Pesées”. 1 pesée equals 144 pounds 	*(National Archives Brussels, Finance Council, 5030, note on exports, August 2nd 1779). The weight of a charretée is unfortunately uncertain, 	*but we have assumed it equals the weight of 5 quarters (1 quarter = 300 pounds, NAB, FC, 5022, letter by J.J. De la Tombeke, Tirlemont, November 30th 1760)"	replace quantity = quantity*1500 if unit=="charrée" | unit=="charretée"	replace quantity = quantity*144 if unit=="pesée"	replace quantity = quantity*300 if unit=="quarter"	replace product_prix = "Coal" if strmatch(product_prix,"Coal * pesée")==1	replace product_prix = "small Coal" if strmatch(product_prix,"small Coal * quarter")==1	replace product_prix=subinstr(product_prix,char(202)," ",.)	replace product_prix=subinstr(product_prix," "," ",.)	replace unit = "pounds ; export" if (unit=="charrée" | unit=="charretée" | unit=="pesée" | unit=="quarter" | unit=="pounds") & exportimport=="export" & product_prix=="Coal"	replace unit = "pounds ; import" if (unit=="charrée" | unit=="charretée"| unit=="pesée" | unit=="quarter" | unit=="pounds") & exportimport=="import" & product_prix=="Coal"	replace unit = "pounds ; import" if (unit=="charrée" | unit=="charretée"| unit=="pesée" | unit=="quarter" | unit=="pounds") & exportimport=="transit" & product_prix=="Coal"	replace unit = "pounds" if (unit=="charrée" | unit=="charretée"| unit=="pesée" | unit=="quarter" | unit=="pounds") & product_prix=="small Coal"	replace unit=subinstr(unit,char(202)," ",.)	replace unit=subinstr(unit," "," ",.)}if "`bien'"=="Sugar" {	keep if sitc18_rev3=="0b"	keep if strmatch(marchandises_simplification,"*sucre*")==1}if "`bien'"=="Linen" {	keep if sitc18_rev3=="6d"	keep if strmatch(product_prix,"*linen cloth*")==1	replace quantity = 60*quantity if unit=="pieces"	replace unit = "ell" if unit=="pieces"}if "`bien'"=="French wine" {	keep if product_prix=="French wine"	replace unit = "aime" if unit=="awm"}if "`bien'"=="Silk" {	keep if sitc18_rev3=="6f"	generate value_silvkg	= quantity*8.7363/1000 if unit=="guilders"	replace  value_silvkg	= quantity*3*8.7363/1000 if unit=="ell"	*replace value_silvkg	= (quantity/0.036)*3*8.7363/1000 if unit=="pounds"	*Suppose qu'il faut 0,108 livres de soie pour une aulne + fait l'hypothèse que 2/3 du tissu est fait d'autre chose. 	replace value_silvkg	= (quantity/0.108)*3*8.7363/1000 if unit=="pounds"	replace value_silvkg	= quantity*15*3*8.7363/1000 if unit=="pieces"}if "`bien'"!="Silk" {	merge m:1 product_prix unit year using "Stata/RG_prix.dta", keep (1 3)	generate value_silvkg = quantity*prix*8.7363/1000}collapse (sum) value_silvkg , by(year exportimport)format value_silvkg %9.2gc*list if exportimport=="export"*list if exportimport=="import"save "Stata/`bien'.dta", replace*Puis la France*******use "~/Documents/Recherche/Commerce International Français XVIIIe.xls/Balance du commerce/Retranscriptions_Commerce_France/Données Stata/bdd courante.dta", clearkeep if strmatch(pays_grouping,"*Flandre*")==1keep if sourcetype == "Objet Général" | sourcetype == "National par direction"destring year, replacereplace exportsimports = "Imports" if exportsimports == "Importations"replace exportsimports = "Exports" if exportsimports == "Exportations"if "`bien'"=="Coal" {	keep if sitc18_rev3=="3"	keep if strmatch(marchandises_simplification,"*bois*")!=1 	keep if strmatch(marchandises_simplification,"*boulanger*")!=1 	keep if strmatch(marchandises_simplification,"*charbon*")==1 }if "`bien'"=="Sugar" {	keep if sitc18_rev3=="0b"	keep if strmatch(marchandises_simplification,"*sucre*")==1}if "`bien'"=="Linen" {	keep if sitc18_rev3=="6d"	keep if strmatch(marchandises_simplification,"*toile*lin*")==1 | strmatch(marchandises_simplification,"*treillis*")==1 | strmatch(marchandises_simplification,"toile grosse")==1}if "`bien'"=="Silk" {	keep if sitc18_rev3=="6f"}if "`bien'"=="French wine" {	keep if sitc18_rev3=="1"	keep if strmatch(marchandises_simplification,"vin*")==1}generate value_silvkg=value*4.47/1000rename quantit quantitycollapse (sum) value_silvkg quantity, by(year exportsimports)rename exportsimports exportimportreplace exportimport="exportFR" if exportimport=="Imports"replace exportimport="importFR" if exportimport=="Exports"append using "Stata/`bien'.dta"drop quantityreshape wide value_silvkg,i(year) j(exportimport) stringrename value_silvkg* *save "Stata/`bien'.dta", replaceuse "Stata/`bien'.dta", clearcorrelate corr exportFR exportlocal corr : display %3.2f r(rho)twoway (connected exportFR year ) (line export year ),/**/ legend(label(1 "From AN to France (FR)") label(2 "From AN to World (AN)")) ytitle("in silver kg") title("`bien'") subtitle("Corr : `corr'")graph export "Graphiques/charbonX.png", replacecorr importFR importlocal corr : display %3.2f r(rho)twoway (connected importFR year) (line import year),/**/ legend(label(1 "From France to AN (FR)") label(2 "From World to AN (AN)")) ytitle("in silver kg") title("`bien'") subtitle("Corr : `corr'")graph export "Graphiques/charbonI.png", replacegenerate import_transit = import+transitcorr importFR import_transitlocal corr : display %3.2f r(rho)twoway (connected importFR year) (line import year ) (line import_transit year ) ,/**/ legend(label(1 "From France to AN (FR)") label(2 "From World to AN (AN)") label(3 "Transit through AN (AN)")) ytitle("in silver kg") title("`bien'") subtitle("Corr : `corr'")graph export "Graphiques/charbonI+T.png", replaceerase "Stata/`bien'.dta"end*graphiques_en_valeur Coal*graphiques_en_valeur Sugar*graphiques_en_valeur Linen*graphiques_en_valeur Silkgraphiques_en_valeur "French wine"/***************** Pour les tissus de laine***************use "Statistiques/RG_base.dta", cleardrop dutchtranslation productrename originalfrenchname marchandisesmerge m:1 marchandises using "~/Documents/Recherche/Commerce International FrancÃßais XVIIIe.xls/Balance du commerce/Archives/Retranscriptions_Commerce_France/bdd_marchandises_normalisees_v20.dta", keep(3) nogeneratedrop marchandises_normalisees_inter dutchtranslation-source_francemerge m:1 marchandises_normalisees using "~/Documents/Recherche/Commerce International FrancÃßais XVIIIe.xls/Balance du commerce/Archives/Retranscriptions_Commerce_France/bdd_marchandises_classifiees_v15.dta",keep(3) nogeneratedrop remarques_marchandises-marchandises_pour_graphe_rgkeep if sitc_rev2=="6b"*[...]*********************** Pour le vin français**********************use "Statistiques/RG_base.dta", cleardrop dutchtranslation productrename originalfrenchname marchandisesmerge m:1 marchandises using "~/Documents/Recherche/Commerce International FrancÃßais XVIIIe.xls/Balance du commerce/Archives/Retranscriptions_Commerce_France/bdd_marchandises_normalisees_v20.dta", keep(3) nogeneratedrop marchandises_normalisees_inter dutchtranslation-source_francemerge m:1 marchandises_normalisees using "~/Documents/Recherche/Commerce International FrancÃßais XVIIIe.xls/Balance du commerce/Archives/Retranscriptions_Commerce_France/bdd_marchandises_classifiees_v15.dta",keep(3) nogeneratedrop remarques_marchandises-marchandises_pour_graphe_rgkeep if product_prix=="French wine"replace unit = "aime" if unit=="awm"merge m:1 product_prix unit year using "Statistiques/RG_prix.dta", keep (1 3)generate value_silvkg = quantity*prix*8.7363/1000collapse (sum) value_silvkg , by(year exportimport)format value_silvkg %9.2gclist if exportimport=="export"list if exportimport=="import"save "Statistiques/Frenchwine.dta", replace *Puis la France*******use "~/Documents/Recherche/Commerce International FrancÃßais XVIIIe.xls/Balance du commerce/Archives/Retranscriptions_Commerce_France/bdd_courante.dta", clearkeep if pays_regroupes=="Flandre"keep if marchandises_simplifies=="Vin ; de France"generate value_silvkg=value*4.47/1000rename quantit quantitycollapse (sum) value_silvkg quantity, by(year exportsimports)rename exportsimports exportimportreplace exportimport="exportFR" if exportimport=="Imports"replace exportimport="importFR" if exportimport=="Exports"append using "Statistiques/Frenchwine.dta"twoway (connected value_silvkg year if exportimport=="exportFR") (line value_silvkg year if exportimport=="export"),/**/ legend(label(1 "From AN to France (FR)") label(2 "From AN to World (AN)")) ytitle("in silver kg") title("French wine")graph export FrenchWineX.png, replacetwoway (connected value_silvkg year if exportimport=="importFR") (line value_silvkg year if exportimport=="import"),/**/ legend(label(1 "From France to AN (FR)") label(2 "From World to AN (AN)")) ytitle("in silver kg") title("French wine")graph export FrenchWineI.png, replacegenerate blouk = 0replace blouk = 1 if exportimport =="import"replace blouk = 1 if (exportimport =="transit")bys blouk year :egen value_silvkg_IT = total(value_silvkg)twoway (connected value_silvkg year if exportimport=="importFR") (line value_silvkg year if exportimport=="import") (line value_silvkg_IT year if blouk==1) ,/**/ legend(label(1 "From France to AN (FR)") label(2 "From World to AN (AN)") label(3 "Transit through AN (AN)")) ytitle("in silver kg") title("French wine")graph export FrenchWineI+T.png, replace